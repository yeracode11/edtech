Проект представляет собой EdTech-платформу с платным доступом к обучающим курсам. Пользователь регистрируется на сайте, выбирает курс или тариф, оплачивает его и после подтверждения оплаты получает доступ к обучающей платформе, где размещены видеоуроки и тесты. Администратор управляет пользователями, курсами, видео, тестами и оплатами через встроенную админ-панель.

Архитектура проекта построена по принципу разделения frontend и backend. Клиентская часть реализуется на Next.js с использованием App Router и TypeScript. Next.js используется как для публичной части сайта (лендинг, каталог курсов, страницы курсов), так и для личного кабинета пользователя и админ-панели, доступной по маршруту `/admin`. В одном проекте используются разные layout’ы для пользовательской части и админки. Для интерфейса применяется Tailwind CSS и shadcn/ui. Воспроизведение видео осуществляется через hls.js, так как видео хранится в формате HLS.

Backend реализуется на Node.js с использованием Express.js и TypeScript. Backend предоставляет REST API для авторизации, управления пользователями, курсами, уроками, тестами, прогрессом и оплатами. В проекте используется JWT-аутентификация с access и refresh токенами, которые хранятся в HttpOnly cookies. Для контроля доступа применяются middleware, которые проверяют авторизацию пользователя и его роль (USER или ADMIN). Все административные маршруты защищены проверкой роли администратора.

В качестве базы данных используется PostgreSQL. Работа с базой данных осуществляется через Prisma ORM. В базе хранятся данные о пользователях, ролях, курсах, уроках, видеоуроках, тестах, вопросах и ответах, прогрессе прохождения курсов, платежах и подписках. Реляционная структура базы позволяет легко связывать курсы с уроками, уроки с тестами и отслеживать прогресс каждого пользователя.

Видео не хранятся напрямую на backend-сервере. Для хранения используется Google Cloud Storage с приватным bucket’ом. Видео предварительно конвертируются в формат HLS (m3u8 + ts сегменты) с помощью FFmpeg. Доступ к видео осуществляется через временные Signed URLs. Когда пользователь запрашивает видеоурок, backend проверяет, имеет ли он доступ к данному курсу и уроку, после чего генерирует временные ссылки на HLS-сегменты (обычно на 5–10 минут) и возвращает плейлист. Frontend воспроизводит видео через hls.js. Такое решение не является полноценной DRM-защитой, но значительно усложняет несанкционированное скачивание видео и подходит для бесплатной инфраструктуры на этапе MVP.

Оплата курсов и тарифов осуществляется через платёжные системы (Kaspi, PayBox, CloudPayments и аналогичные). После инициации оплаты платёжная система отправляет webhook на backend. Backend валидирует webhook, сохраняет информацию о платеже в базе данных и активирует доступ пользователя к соответствующему курсу или тарифу. После этого пользователь сразу получает доступ к контенту.

Логика обучения предполагает, что пользователь просматривает видеоуроки и после каждого урока может проходить тест. Результаты тестов сохраняются в базе данных. В зависимости от настроек курса следующий урок может быть заблокирован до успешного прохождения теста. Также сохраняется прогресс пользователя по каждому курсу, что позволяет отображать статус обучения в личном кабинете.

Админ-панель позволяет администраторам создавать и редактировать курсы, добавлять уроки, загружать видео, создавать тесты и вопросы, управлять пользователями, назначать доступы и просматривать информацию об оплатах. Админка реализована в том же Next.js-приложении, что и пользовательская часть, но логически и визуально отделена.

Архитектура проекта ориентирована на быстрое создание MVP с минимальными затратами, понятное разделение ответственности между слоями приложения и возможность дальнейшего масштабирования. При необходимости backend на Express.js может быть безболезненно мигрирован на NestJS, а видеохранилище — заменено на платные сервисы с полноценной DRM-защитой без изменения логики фронтенда и базы данных.
